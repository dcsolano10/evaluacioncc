theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuRd"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "YlOrRd"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBuGn"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
library("xlsx")
library("ggplot2")
library("ggthemes")
library("scales")
library("RColorBrewer")
#Cargar archivo de datos
datos <- read.xlsx("C:/Users/kd.angulo2295/Dropbox/Uniandes Daniela/TESIS/Software/Modelo de la Prevención/Resultados/V, 12 Edad, 1-10 AñosVac PIgual/Indicadores/Todas Políticas VNuevo.xlsx", sheetIndex = 1)
datos$Vaccine <- factor(datos$Vaccine, levels = c("20% ","40% ","60% ","80% ","100%"))
datos$T.V <- factor(datos$T.V, levels = c("20% W&M","20% Women","40% Men","40% W&M","40% Women","60% Men","60% W&M","60% Women","80% Men","80% W&M","80% Women","100% Men","100% W&M","100% Women","20% Men"))
#----Generar los subsets de compartimiento e indicador----
#CIN1
datosCasesCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Death Rate" & datos[,1] == 30)
#CIN23
datosCasesCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Death Rate" & datos[,1] == 30)
#Cancer
datosCasesCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Death Rate" & datos[,1] == 30)
#----Generar gráficas-----------------------------------
#Gráficas CIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphIncidenceCIN1 <- ggplot(datosIncidenceCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
#Gráficas CIN23
graphCasesCIN23 <-  ggplot(datosCasesCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.19, by = 0.02))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphIncidenceCIN23 <- ggplot(datosIncidenceCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.19, by = 0.02))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
#Gráficas Cancer
graphCasesCancer <- ggplot(datosCasesCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalente Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.005, by = 0.0005))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphIncidenceCancer <- ggplot(datosIncidenceCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.005, by = 0.0005))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000015, by = 0.0000005))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
library("xlsx")
library("ggplot2")
library("ggthemes")
library("scales")
library("RColorBrewer")
#Cargar archivo de datos
datos <- read.xlsx("C:/Users/kd.angulo2295/Dropbox/Uniandes Daniela/TESIS/Software/Modelo de la Prevención/Resultados/S, Primary Triage/Indicadores/Todas Políticas Primary Triage.xlsx", sheetIndex = 1)
datos$Primary <- factor(datos$Primary, levels = c("C","H"))
datos$Triage <- factor(datos$Triage, levels = c("C","H"))
datos$PStep <- factor(datos$PStep, levels = c("3","5"))
datos$Tstep <- factor(datos$Tstep, levels = c("3","5","8"))
datos$T.V <- factor(datos$T.V, levels = c("1-1-3","Actual","C5-C5","C5-H5","H5-C5","H5-H5","C3-C3","C3-H3","H3-C3","H3-H3","C5-C8","C5-H8","H5-C8","H5-H8"))
#----Generar los subsets de compartimiento e indicador----
#CIN1
datosCasesCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Death Rate" & datos[,1] == 30)
#CIN23
datosCasesCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Death Rate" & datos[,1] == 30)
#Cancer
datosCasesCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Death Rate" & datos[,1] == 30)
#----Generar gráficas-----------------------------------
#Gráficas CIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606","#A9BCF5"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 3.9, by = 0.35))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphIncidenceCIN1 <- ggplot(datosIncidenceCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 3.9, by = 0.35))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
#Gráficas CIN23
graphCasesCIN23 <-  ggplot(datosCasesCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1, by = 0.1))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphIncidenceCIN23 <- ggplot(datosIncidenceCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1, by = 0.1))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
#Gráficas Cancer
graphCasesCancer <- ggplot(datosCasesCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalente Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.026, by = 0.0035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphIncidenceCancer <- ggplot(datosIncidenceCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.026, by = 0.0035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15),guide = guide_legend(nrow=2))
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15)[3:15],guide = guide_legend(nrow=2))
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15)[4:16],guide = guide_legend(nrow=2))
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(16)[4:16],guide = guide_legend(nrow=2))
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(16)[4:16],guide = guide_legend(nrow=2))
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_grey( start = 0.2, end = 0.8, na.value = "red")
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_grey( start = 0.8, end = 0.2, na.value = "red")
graphDeathRateCancer
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_grey( start = 0.8, end = 0.4, na.value = "red")
graphDeathRateCancer
library("xlsx")
library("ggplot2")
library("ggthemes")
library("scales")
library("RColorBrewer")
#Cargar archivo de datos
datos <- read.xlsx("C:/Users/kd.angulo2295/Dropbox/Uniandes Daniela/TESIS/Software/Modelo de la Prevención/Resultados/V, 12 Edad, 1-10 AñosVac PIgual/Indicadores/Todas Políticas VNuevo.xlsx", sheetIndex = 1)
datos$Vaccine <- factor(datos$Vaccine, levels = c("20% ","40% ","60% ","80% ","100%"))
datos$T.V <- factor(datos$T.V, levels = c("20% W&M","20% Women","40% Men","40% W&M","40% Women","60% Men","60% W&M","60% Women","80% Men","80% W&M","80% Women","100% Men","100% W&M","100% Women","20% Men"))
#----Generar los subsets de compartimiento e indicador----
#CIN1
datosCasesCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Death Rate" & datos[,1] == 30)
#CIN23
datosCasesCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Death Rate" & datos[,1] == 30)
#Cancer
datosCasesCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Death Rate" & datos[,1] == 30)
#----Generar gráficas-----------------------------------
#Gráficas CIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphIncidenceCIN1 <- ggplot(datosIncidenceCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
#Gráficas CIN23
graphCasesCIN23 <-  ggplot(datosCasesCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.19, by = 0.02))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphIncidenceCIN23 <- ggplot(datosIncidenceCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.19, by = 0.02))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
#Gráficas Cancer
graphCasesCancer <- ggplot(datosCasesCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalente Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.005, by = 0.0005))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphIncidenceCancer <- ggplot(datosIncidenceCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.005, by = 0.0005))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000015, by = 0.0000005))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(18)[3:18],guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(20)[20:18],guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "PuBu"))(20)[5:20],guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "Oranges"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "Greens"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "Blues"))(15),guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+theme(panel.grid.major.x =element_blank())+ scale_fill_manual(values = colorRampPalette(brewer.pal(8, "Blues"))(20)[5:20],guide = guide_legend(nrow=2))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1.7, by = 0.2))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_x_discrete(labels = c("20%\nMen","40%\nMen","60%\nMen","80%\nMen","100%\nMen","100%\nW&M","80%\nW&M","60%\nW&M","40%\nW&M","20%\nW&M","100%\nWomen","80%\nWomen","60%\nWomen","40%\nWomen","20%\nWomen"))
graphCasesCIN1
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
library("xlsx")
library("ggplot2")
library("ggthemes")
library("scales")
library("RColorBrewer")
datos <- read.xlsx("C:/Users/kd.angulo2295/Dropbox/Uniandes Daniela/TESIS/Software/Modelo de la Prevención/Resultados/VacScreening/Indicadores/VacScreening.xlsx", sheetIndex = 1)
datos$Vtarget <- factor(datos$Vtarget, levels = c("M","W","W&M"))
datos$Primary <- factor(datos$Primary, levels = c("C","H"))
datos$Triage <- factor(datos$Triage, levels = c("C","H"))
datos$T.V <- factor(datos$T.V, levels = c("M20% - C","M20% - H","W20% - C","W20% - H","W&M20% - H","W&M20% - C","M20% - C - C","M20% - C - H","W20% - C - C","W20% - C - H","W&M20% - C - C","W&M20% - C - H","M20% - H - C","M20% - H - H","W20% - H - C","W20% - H - H","W&M20% - H - C","W&M20% - H - H","Actual"))
datosCasesCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN1 <- subset(datos, datos[,2] == "CIN1" & datos[,3] == "Death Rate" & datos[,1] == 30)
datosCasesCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCIN23 <- subset(datos, datos[,2] == "CIN23" & datos[,3] == "Death Rate" & datos[,1] == 30)
datosCasesCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Cases" & datos[,1] == 30)
datosIncidenceCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Incidence" & datos[,1] == 30)
datosDeathRateCancer <- subset(datos, datos[,2] == "Cancer" & datos[,3] == "Death Rate" & datos[,1] == 30)
graphCasesCIN1 <- ggplot(datosCasesCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606","#A9BCF5"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 3.9, by = 0.35))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphIncidenceCIN1 <- ggplot(datosIncidenceCIN1, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN1")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 3.9, by = 0.35))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphCasesCIN23 <-  ggplot(datosCasesCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1, by = 0.1))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphIncidenceCIN23 <- ggplot(datosIncidenceCIN23, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,3),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for CIN23")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 1, by = 0.1))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphCasesCancer <- ggplot(datosCasesCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Prevalente Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.026, by = 0.0035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphIncidenceCancer <- ggplot(datosIncidenceCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,4),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", fill = NA, size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Incidence Efectiveness for Cancer")+
ggtitle("Vaccination Strategies Comparison")+scale_fill_manual(values=c("#f2a6a6","#f7a1a1","#fc9c9c","#e08585","#e87d7d","#f07575","#f76e6e","#f65a5a","#fb5656","#d3312c","#d92626","#df2020","#e61919","#ec1313","#f20d0d","#f90606"))+
theme(panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.026, by = 0.0035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(1,1,1,1), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)
graphDeathRateCancer <- ggplot(datosDeathRateCancer, aes(x = reorder(T.V,Efectividad), y = Efectividad,label = round(Efectividad,6),fill=reorder(T.V,Efectividad)))+ geom_bar(stat = "identity", position = "dodge")+theme_bw()+
theme(panel.background = element_blank() ,panel.border = element_rect(colour = "grey", size = 0.5),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5),axis.text.y = element_text(angle = 0, hjust = 0.5, vjust = 0.4), plot.title = element_text(size= 20,hjust = 0.5)) +xlab("") + ylab("Death Rate Efectiveness for Cancer")+
ggtitle("Screening Policies Comparison")+theme(panel.grid.major.x =element_blank() ,panel.grid.major.y = element_line(colour="grey", size=0.5),legend.title=element_blank(), legend.text = element_text(size = 8))+ scale_y_continuous(breaks = seq(0.0, 0.000045, by = 0.0000035))+
theme(axis.line.x = element_line(color="darkgray", size = 0.5),axis.line.y = element_line(color="darkgray", size = 0.5))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),legend.box.background = element_rect(),legend.box.margin = margin(0.5, 0.5, 0.5, 0.5),legend.direction = "horizontal", legend.position = "none",legend.key = element_rect(size = 5),legend.key.size = unit(0.3, 'lines'))+
geom_text(size = 3, position = position_dodge(width=0.9),vjust=-0.75)+
scale_fill_grey( start = 0.8, end = 0.4, na.value = "red")
graphDeathRateCancer
shiny::runApp()
shiny::runApp()
